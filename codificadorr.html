<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Codificador/Decodificador</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background-color: #f0f0f0; }
        table { border-collapse: collapse; margin-top: 20px; width: 100%; max-width: 500px; }
        th, td { border: 1px solid #333; padding: 8px; text-align: center; }
        input, textarea, button { padding: 8px; margin: 5px 0; width: 100%; box-sizing: border-box; }
        button { cursor: pointer; }
    </style>
</head>
<body>
    <h2>Codificador / Decodificador</h2>

    <label for="mensaje">Escribe el mensaje a codificar o los números a decodificar:</label>
    <textarea id="mensaje" rows="3"></textarea>

    <select id="opcion">
        <option value="C">Codificar</option>
        <option value="D">Decodificar</option>
    </select>

    <button onclick="procesar()">Procesar</button>

    <h3>Resultado:</h3>
    <div id="resultado"></div>

    <h3>Tabla de letras y números</h3>
    <table>
        <tr>
            <th>Letra</th>
            <th>Número</th>
        </tr>
        <tbody id="tabla">
        </tbody>
    </table>

    <script>
        // Crear tabla de letras y números
        const tabla = document.getElementById("tabla");
        for(let i=0; i<26; i++){
            const tr = document.createElement("tr");
            const letra = String.fromCharCode(65+i);
            const numero = i+1;
            tr.innerHTML = `<td>${letra}</td><td>${numero}</td>`;
            tabla.appendChild(tr);
        }

        function codificar(mensaje){
            mensaje = mensaje.toUpperCase();
            let resultado = [];
            for(let letra of mensaje){
                if(letra === " "){
                    resultado.push(0); // espacio
                } else if(letra >= "A" && letra <= "Z"){
                    let n = letra.charCodeAt(0) - 65 + 1;
                    let codificado = 0.8 * Math.pow(n, 1.5) + 1;
                    resultado.push(Math.round(codificado));
                }
            }
            return resultado;
        }

        function decodificar(codigos){
            let resultado = "";
            for(let num of codigos){
                if(num === 0){
                    resultado += " ";
                } else {
                    let valor = Math.pow((num - 1)/0.8, 2/3);
                    let letra_num = Math.round(valor);
                    if(letra_num >= 1 && letra_num <= 26){
                        resultado += String.fromCharCode(64 + letra_num);
                    } else {
                        resultado += "?";
                    }
                }
            }
            return resultado;
        }

        function procesar(){
            const opcion = document.getElementById("opcion").value;
            const entrada = document.getElementById("mensaje").value.trim();
            let salida = "";

            if(opcion === "C"){
                const codigos = codificar(entrada);
                salida = codigos.join(" ");
            } else if(opcion === "D"){
                const codigos = entrada.split(" ").map(x => parseInt(x));
                salida = decodificar(codigos);
            }

            document.getElementById("resultado").innerText = salida;
        }
    </script>
</body>
</html>